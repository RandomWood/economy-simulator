using Xunit.Abstractions;

namespace Roblox.UnitTest;

public class ImageTest
{
    private readonly ITestOutputHelper _testOutputHelper;

    public ImageTest(ITestOutputHelper testOutputHelper)
    {
        _testOutputHelper = testOutputHelper;
    }

    // This is a jpeg someone uploaded that gave an error in RCC and jimp but was validated successfully by imagesharp.
    // fix was to upgrade to imagesharp 2.
    private const string BadJpegBase64 = "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8888YE88888ck888888wwwwwwwww888884EAU08Qg8EU8s884IMAU0oAkcc4888sYU8cYUYww0888888888888888888888888888888880888888M8s88888sc88888884U88888888888888888888888888888888888wwwww88888884w//EABsRAAEEAwAAAAAAAAAAAAAAAAABESExIFFw/9oACAEDAQE/EMbQb4I3KSLKMX7rH//EABsRAAICAwEAAAAAAAAAAAAAAAABETEgIVFw/9oACAECAQE/EMaQcwOXTFLSV71j/8QAKhABAAIBBAAGAwACAwEAAAAAAQARITFBUWEgcYGRwfAQMKFAsWBw0eH/2gAIAQEAAT8Q/JxNJGodionmU+jDFfgTJct6xM8ochyCXL5Vtyv5pBZJ2C3vpMuZwKe5A2RjHRkBc0v3tvsQdXHH/hCaK6Z94rTJWlwBoH4NN5SKsaj3Meo/y4wFUdUbWOniY/OEnA19RZ6zsi2gWQBTwaoE2WoCtx0irggoZVtsMCPvkbj05lzYIBUMFSbCMDQB4FYszXpMyui6Awep7rCMCV4RnEzQU1cq2e1j1JXC58Aaoc5zCQAGZUcrs2vnu6MdzEvy3A4GgdEQRRqkHvf6dTAhLUfAPZ7RSrQItpgiWZ8AMvISlfIbrY97/THTqp1Rtfxv+dIP5GI6LSu2EX0afSA2Gx35g2X+AXMrW1RQVB1B43PPTuOUzBgn9PIx5zl0lVLI8p7ClcjtDzdQuAeeh889wKbabTcJlecYCQjOfxYLtMgPbMm+juAafTKw8NSs+A6zuEtyoyedPZgnnQiLOZj6RRaA5XiKVvYVp1396ecRYl2y9dHRiBXg1jab0OkeTydOJVxosj5eTzLOiCauzwdJLMSd8HMUQaTutge/8GK3VTqja/r0RKADJwHL9c+onD0b2hv27NjtxHG3ZSuDuf51Ah46jliXfZf0g5KYTjMD4E+VPNlpVluMW7tKcIaej+rB+xNpZtQbH3mAnDiMYbmbyx1HfbZkdrA/WhKDmUYChjZWHWPLSPZT1ZG1/alwgP3IgV+u+mX0y+mejL6ZfTL6ZfTL6ZfTL6ZfTL6ZfTL6ZfTL6ZfTL6ZfTL6Z6P6saKLADZN6T3n3/wCJ9f8AifX/AIn1/wCJ9f8Aiff/AIn3/wCJ9f8AifX/AIn1/wCJ9/8Aiff/AIn1/wCJ9f8AifX/AIn1/wCJ9f8Aifb/AImWkjjq6TbCfrrBGKavb/sNMTitwle5jmGOm6eSDyDVWA4bmjCCTFwiL8rhYBtAX16xYV3GrfOB5tQV6UmzbNMFntbo2vnz8BXGhC9CPk94A6tQUY5OjPABzegqbz6hgYvn8ET3/oIcagbM9Elq5WkfKtK2FW7kXCbVFGta2YjhtLEg0fjNpjXpXwK+OtrU72vmDXJskCiaBm3UxjJB5NZuejRp6HZQqA1bPQNr1L4JY71o92waXsUUtNTC/kvDbWtZWJHmHMBphADKEVrEtoll7vAFSIU5TjqWxxwR2lpV9sh3NPTedQbJfljymsPJVrYWL8o/wN1gnI8Jz1KEOT/6Mfl5c+GvJ1peE0SDYSIpi8ucbO5/H/KxJXip1EAuyv4l281VdW9sD2lEbmUNB6Mi1buWrFVdcSwE3cF7A1rMmUnVGxaOhnq9CKEtXAx6FbV09jFiofVJOOSOQfDSovbdt53UxmmDGGwtLG633id2oYZpSiN1gxjYikgMCCDVwBo3t3l1XwbMqkyFKmI+yYiCQoANoj+f4W/F5NEbNtHmill1dvSJmIYwxnxYU85t+C56qqyUtubBHYDzGJ8sqMQGGkLK1K7SrWIa3FcHgGiXiGjIdQAoA4iWQwtzpCAXcdpecfWWR0uYMtdKFUXhtWzCJxiBUfFmE1bFmrNDrHsJVsVXUF53VcXQxiT+qssOChDlXEci6DoV6Cfy/wAqy5fiYVVp/u/3HxqBG5A7yjylyTWBMNv7Ep7hLY484xS1EcCiVTGBrXQoyG1y+dVDau6ty43u49m7dsSjcuRCryW1VxV8BCrZGllC9GrWtWcqMFitUFDV0g6NIMipjcR61fM4lLndre1dPbBztESxCGBfAYatKzMZqqgPFi11FqbuLzBDYJuXh0X0W9TS4/qNaAbZEvqGbWyT3d/k/k/lqVK8VM0ZfkVl7oq/SZsUEyyAOZQ1KNSi3Ba6h+NW1UVyyqWYGADPPeFwBQbzUD3XB4Ril+RrdtxgqVasx/PxtUHWJZDgVic1l3WCoSrzgGnLQoh1AOEF81r6HBsEEbJZW8x2+zqUyjtgcOWuhJsiDCnAOB5Zmlkwm/NP/wARZODCforvlddSvdKQB4Ih569x0yuvgzXCyLxbzEYOKyoq+yr3lDCEkSgpr/zFZLP8lly5bMzMD9d/vqVMcTHH7KhZB/wGXL/Xj/BojAf9QWy2XFl4gy5cuXLly5bLZbLZbLZbLZbLZbLZbLZcuXP/2Q==";
    
    [Fact]
    public async Task ReadBadImageAndFail()
    {
        var bytes = Convert.FromBase64String(BadJpegBase64);
        var img = new MemoryStream(bytes);

        await Assert.ThrowsAnyAsync<Exception>(async () =>
        {
            await SixLabors.ImageSharp.Image.LoadWithFormatAsync(img);
        });
    }
}